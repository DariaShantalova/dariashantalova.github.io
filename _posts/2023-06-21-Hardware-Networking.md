Sources:
* <https://where-to-store-the-packet.readthedocs.io/en/latest/0_intro.html>
* <https://linkmeup.ru/blog/1262/> - как построить гугл
* <https://thenetworksherpa.com/tcam-in-the-forwarding-engine/>
* <https://linkmeup.ru/blog/1235/> Packet Way
* Brian Petersen Hardware-Defined Networking Kindle Edition
* <https://habr.com/ru/companies/selectel/articles/313150/ >
  Для последнего десятилетия характерна тенденция к маршрутизации в софте. Для всех сетевых функций предлагаются программные альтернативы. Отсюда и DMA, DPDK, VPP, SR-IOV, которые и правда позволяют творить невиданные прежде вещи.



Пост является вольным конспектом этих ресурсов. Направлен на самообучение путем структурирования информации.

# Архитектура сетевых устройств
  
<img width="730" alt="Screenshot 2023-06-25 at 22 23 20" src="https://github.com/DariaShantalova/dariashantalova.github.io/assets/34622678/1c9f1710-5158-441f-bf26-4094e478fb77">

1. электрический или световой сигнал попадает через физический интерфес на устройство
2. Обрабатывается в поток битов
3. Вычленяются заголвки (парсинг - ethernet, mpls, ip и тд)
4. Traffic manager - происходит обработка, решение куда послать, полисинг, буферезация, фильтры, qos и т д
5. Происходит обратное превращение этого всего в биты
6. Отправка на физические интерфей

   3,4,5 существует благодоря control plane, на котором работают протоколы маршрутизауии

   блок задач - чип
   преобразование в биты, работа с физикой - PHY - обычно это ASIC
   CONTROL PLANE - CPU + RAM
   Parser, Traffic management, Deparser (обработка заголовков, перенаправление трафика - Packet Forwarding Manager) -
   может быть Network Processor, FPGA, cпециализированный ASIC)
   Parser - TCAM, RAM,

## Архитектрура модульных устройств
* Back Plane
* управляющий модуль
* линейная карта/интерфейсный модуль
* фабрика коммутации
  
 ### Фабрика Коммутации
 маршрутизатор операторского класса -> от 2х до десятков линейный/интерфейсхных карт -> минимум 1 FE на каждую
 Как соединить? - через транзитный элемент
 <img width="718" alt="Screenshot 2023-06-26 at 19 08 04" src="https://github.com/DariaShantalova/dariashantalova.github.io/assets/34622678/dc2432d1-c079-4268-b39c-36f9ca0e0290">
 По сути сборка тупых ASIC перенаправляющая ячейки. Часто фабрика коммутации подключены прямо в управляющий модуль.

Далее разбитие на ячейки, чтобы не было проблем по сбору.
Ячейка маленькая, расстояние одинаковое, доходит за одно время, еще и пронумерована.


##  Типы чипов
### Чипы
На сегодняшний день нет идеального варианта, поэтому для каждой цели ищется компромисс.

Чипы коммутации:
* CPU - Central Process Unit
* FPGA - Field Programmable Gate Array
* ASIC - Application Specific Integrated Cirfcuit
* NP - network processor
* Programmable ASIC

Чипы памяти:
* RAM - Random Access Memory
* CAM - Content Access Memory
* TCAM - Ternary Content Access Memory
* Алгоритмический поиск

### CPU - Central Process Unit
+ неограниченная функциональность
+ неограниченная гибкость
+ - цена
- производительность

идея: все реализуется программно, инструкции в оперативной памяти, для каждого пакета поход в оперативку
для изменения функционала: достаточно изменить программу
область применения: домашние роутеры, firewall, control plane в маршрутизаторах

в современных процессорах реализуется программная маршрутизация и это уже заходит в область np - network processor
но пока цены этого cpu большая и он еще будет кушать электричество

   

  
 
   
